{% extends 'base.html' %}
{% block title %}Share Camera{% endblock %}
{% block content %}
<div style='max-width:800px; margin:40px auto;'>
  <h2 style='color:white; text-align:center; margin-bottom:20px;'>ğŸ”— Share Camera</h2>
  <div class='card'>
    <p><strong>Camera ID:</strong> {{ camera.camera_id }}</p>
    <p><strong>Name:</strong> {{ camera.name }}</p>
    <hr style='margin:20px 0;'>
    <h3>Share with another user</h3>
    <form method='POST' style='margin-top:15px;'>
      <div class='form-group'>
        <label>Select User:</label>
        <select name='user_id' required style='width:100%; padding:12px; border:2px solid #e0e0e0; border-radius:6px;'>
          <option value=''>-- Choose a user --</option>
          {% for other in other_users %}
          <option value='{{ other.id }}'>{{ other.username }} ({{ other.email }})</option>
          {% endfor %}
        </select>
      </div>
      <div style='display:flex; align-items:center; gap:10px; margin-bottom:15px;'>
        <input type='checkbox' name='can_edit' id='can_edit'>
        <label for='can_edit'>Allow user to edit camera settings</label>
      </div>
      <button type='submit' class='btn'>Share Camera</button>
    </form>
    <hr style='margin:20px 0;'>
    <h3>Currently Shared With:</h3>
    {% if shares %}
    {% for share in shares %}
    <div style='display:flex; justify-content:space-between; align-items:center;
                padding:15px; border:1px solid #e0e0e0; border-radius:8px; margin:10px 0;'>
      <div>
        <strong>{{ share.shared_user.username }}</strong>
        <span style='color:#666; font-size:14px;'>({{ share.shared_user.email }})</span>
        {% if share.can_edit %}<span style='background:#48bb78; color:white; padding:2px 8px;
          border-radius:12px; font-size:12px; margin-left:8px;'>Can Edit</span>{% endif %}
      </div>
      <form method='POST' action='/cameras/{{ camera.camera_id }}/unshare/{{ share.shared_user.id }}'>
        <button type='submit' class='btn btn-danger' style='padding:8px 16px;'>Remove</button>
      </form>
    </div>
    {% endfor %}
    {% else %}
    <p style='color:#666; font-style:italic;'>Not shared with anyone yet.</p>
    {% endif %}
    <a href='/dashboard' class='btn btn-secondary' style='margin-top:20px; display:inline-block;'>â† Back</a>
  </div>
</div>
{% endblock %}
